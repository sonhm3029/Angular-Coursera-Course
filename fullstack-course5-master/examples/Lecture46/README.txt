All application code copied from Lecture28.
